<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd">
<busconfig>
  <!--
    D-Bus policy for tether service to access BlueZ Bluetooth APIs

    This policy allows the 'tether' user to:
    - Query Bluetooth adapters and devices
    - Read RSSI (signal strength) values
    - Discover nearby devices

    It does NOT allow:
    - Pairing devices
    - Modifying adapter settings
    - Connecting to devices
  -->

  <policy user="tether">
    <!-- Allow sending messages to the BlueZ bus name -->
    <allow send_destination="org.bluez"/>

    <!-- Allow introspection for D-Bus discovery -->
    <allow send_interface="org.freedesktop.DBus.Introspectable"/>

    <!-- Allow reading properties (device name, RSSI, etc.) -->
    <allow send_interface="org.freedesktop.DBus.Properties"/>

    <!-- Allow ObjectManager for device enumeration -->
    <allow send_interface="org.freedesktop.DBus.ObjectManager"/>

    <!-- BlueZ specific interfaces for device discovery -->
    <allow send_interface="org.bluez.Adapter1"/>
    <allow send_interface="org.bluez.Device1"/>
  </policy>
</busconfig>
